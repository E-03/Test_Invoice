@model InvoiceApp.Dto.CustomersDto

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .bs-callout {
        padding: 20px;
        margin: 20px 0;
        border: 1px solid black;
        border-left-color: red;
        border-left-width: 5px;
        border-radius: 3px;
    }
    #CustomerTypeId {
        height: 40px;
        width: 100%;
        border: 1px solid thin;
        border-radius: 6px;
        border-color: grey;
    }
</style>

<h1 class="mt-4">Mantenimiento Cliente</h1>

<div class="bs-callout">

    <div class="form-horizontal">
        <div><strong>Agregar Cliente</strong></div>
        <hr />

        @using (Ajax.BeginForm("PostCustomers", "Customers", new AjaxOptions() { OnComplete = "OnCompleted" }, new { @id = "frmCustomer" }))
        {
            @Html.AntiForgeryToken()
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })

            <div class="row">
                <div class="col-6">
                    <div class="form-group">
                        @Html.LabelFor(model => model.CustName, htmlAttributes: new { @class = "control-label col-md-2" })
                        <div class="col-md-10">
                            @Html.EditorFor(model => model.CustName, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.CustName, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="form-group">
                        @Html.LabelFor(model => model.Adress, htmlAttributes: new { @class = "control-label col-md-2" })
                        <div class="col-md-10">
                            @Html.EditorFor(model => model.Adress, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.Adress, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="form-group">
                        @Html.LabelFor(model => model.CustomerTypeId, htmlAttributes: new { @class = "control-label col-md-2" })
                        <div class="col-md-10">
                            @Html.DropDownListFor(p => p.CustomerTypeId, (IEnumerable<SelectListItem>)ViewBag.fillCustomerTypes, new { htmlAttributes = new { @class = "form-control" } })<br/>
                            @Html.ValidationMessageFor(model => model.CustomerTypeId, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group text-center">
                <div class="col-md-offset-2 col-md-12">
                    <input type="submit" value="Guardar" style="background-color:red; border-color:aliceblue; color:white; font-weight:bold" class="btn btn-primary" />
                </div>
            </div>
        }

    </div>
</div>

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/bootstrap")

<script>
    $(document).ready(function () {
        console.log("ready!");
    });

    function OnCompleted(data) {
        if (data.status === 201) {
            if (data.responseJSON.message !== null) {
                alert(data.responseJSON.message)
                window.location.href = "/Customers/Index";
                return;
            }
            return alert("Error: " + data.responseJSON.message)
            
        }

        console.log("Guardado", data)
        return alert(data.responseJSON.message)

    }
</script>



